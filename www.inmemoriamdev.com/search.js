sites = [
	{ 
		site: "www.albane.euro.st", 
		keywords: [ "naghammadi", "nag hammadi", "nag hammadi library", "gnosis", "christian tradition", "nag hammadi texts" ], 
		description: "Naghammadi. The Nag Hammadi Library. Initiation into gnosis and the Christian tradition, as enlightened by the Nag Hammadi texts"
	},
	{ 
		site: "www.alcina-cooking.com", 
		keywords: [ "alcina", "mazers", "cooking", "cuisine", "marseille", "june 06" ], 
		description: "Alcina's cooking. The website of Alcina Mazers, a young French woman living in Marseille and offering cooking lessons."
	},
	{ 
		site: "www.alternatherapie.net", 
		keywords: [ "auriculotherapy", "ear", "ears", "acupuncture", "audrey defrance" ], 
		description: "Audrey Defrance Website Devoted to Complementary and Alternative Medicines: Magnetism, Chromotherapy, Auriculotherapy, Acupuncture, Aromatherapy."
	},
	{ 
		site: "www.argyll-housesforsale.com", 
		keywords: [ "argyll", "houses for sale", "house", "sale" ], 
		description: "Argyll-HousesForSale.com is the official website of The Argyll Estate Agency."
	},
	{ 
		site: "www.aroundlochawe.com", 
		keywords: [ "loch awe", "monument", "duncan ban macintyre", "mcintyre",  "macintyre", "chapels", "graveyard", "chapel", "cemetery", "kilmartin" ], 
		description: "Around Loch Awe - Monument to Duncan Ban MacIntyre near Dalmally - Craignish Chapel - Old cc Cemetery - Kilchurn Castle - Inveraray Castle - Innis Chonnel Castle." 
	},
	{ 
		site: "www.byronandson.com", 
		keywords: [ "aim", "music", "glory", "god", "soul", "byron", "300 e 12th street" , "12th street", "300 e" ], 
		description: "Aim Music Glory God Soul. The aim and final end of all music should be none other than the glory of God and the refreshment of the soul." 
	},
	{ 
		site: "www.calahorra.info", 
		keywords: [ "josé romero", "jose romero",  "18512", "andalucia", "calahorra", "rodrigo", "dolar", "castle de la calahorra" ], 
		description: "José Romero: « Granada's Calahorra Castle (18512 Andalucia), a former Moorish medieval fortress, conceals a magnificent Renaissance-style palace in its heart, which Don Rodrigo de Mendoza, the natural son of a powerful cardinal, had built for his beloved at the turn of the 16th century." 
	},
	{ 
		site: "www.caledonianhistory.com", 
		keywords: [ "kenneth mac namara", "kenneth macnamara", "kenneth mcnamara", "kenneth mc namara", "historian", "conference" ], 
		description: "January 2003: Kenneth Mac Namara (MacNamara) Conference, Women's History Scotland Conference, Glasgow Quincentennial Conference, …" 
	},
	{ 
		site: "www.californianbloggers.com", 
		keywords: [ "eileen fischer Boyles", "Eileen", "Fischer", "Boyles", "OSCS" ], 
		description: "Stephen's blog. It’s my first post, I guess I should talk about me or something personal. So here’s my blurb..."
	},
	{ 
		site: "www.carneiro-pokerclub.com", 
		keywords: [ "rua de Borges Carneiro", "tarot", "Borges Carneiro" ], 
		description: "Carneiro Poker Club 32, rua de Borges Carneiro - Lisbon" 
	},
	{ 
		site: "www.castelodosmouros.com", 
		keywords: [ "Philosopher's dwelling", "Mountain of the Moon", "Portugal Philosopher", "mountain moon" ], 
		description: "In the shadow of the Mountain of the Moon, the castles of Sintra (Portugal): the Palàcio e Quinta da Regaleira, the mysterious philosopher's dwelling, the Castelo dos Mouros and the Palàcio Nacional da Pena." 
	},
	{ 
		site: "www.cathedrale-paris.net", 
		keywords: [ "history", "french", "cathedrale", "paris", "france capital" ], 
		description: "As a Parisian born and bred and a bit of a history freak, I've decided to devote my own personal web site to our dear old cathedral that has been firmly enthroned for centuries in the very heart of the French capital. " 
	},
	{ 
		site: "www.clairekettley.net", 
		keywords: [ "claire kettley", "scotland", "scottish identity", "kettley" ], 
		description: "Claire Kettley, Scottish and proud of it. I belong to the Scottish nation in a way that’s different from the normal clichés. Without denying the folkloric aspects linked to beer, whisky, bagpipes and haunted castles, I find my Scottish identity through more traditional and introspective aspects. Scotland is a land rich in signs and symbols, and I try my best to draw inspiration from this, so that it really is a part of me." 
	},
	{ 
		site: "www.detective-ari.com", 
		keywords: [ "Ronald Dunckelman", "private investigator", "Dunckelman", "investigator", "investigators" ], 
		description: "Research and Investigation Agency. Founded by Jean-Marie Lefebvre, a private investigator trained by Ronald Dunckelman. The agency is specialised in private investigations for both private individuals and corporate customers."
	},
	{ 
		site: "www.dichters-de.com/", 
		keywords: [ "NOVALIS", "Faith and Love", "Hans Weiffenbach", "faith love" , "Weiffenbach"], 
		description: "Reading list: NOVALIS, Fidèle d'Amour, by Hans Weiffenbach"
	},
	{ 
		site: "www.hermeticum.info", 
		keywords: [ "alchemy", "substance", "hermetic" ], 
		description: "Alchimia est impuri separatio a substantia puriore. Alchemy is the separation of the impure from the most pure substance. est impuri separatio a substantia puriore" 
	},
	{ 
		site: "www.ikl-network.com", 
		keywords: [ "ikl network", "jack lorski", "network", "lorski", "ikl" ], 
		description: "Due to a legal issue, our agency has changed its name and web address: skl-network.com"
	},
	{ 
		site: "www.inmemoriam-fabiopatinha.net", 
		keywords: [ "Fabio Patinha", "Patinha" ], 
		description: "Web site in memory of Fabio PATINHA" 
	},
	{ 
		site: "www.jacquesdemolay.info", 
		keywords: [ "MacBenach", "Mac Benach", "McBenach", "Mc Benach", "shroud", "turin" ], 
		description: "Mac Benach ! MacBenach ! To Jacques de Molay, the last Grand Master of the Order of the Temple ! His life, his trial, his death and his legend." 
	},
	{ 
		site: "www.julie-webzine.net", 
		keywords: [ "julie massenet", "massenet", "icpa", "phoenix investigator", "phoenix" ], 
		description: "Je profite d'une petite pause pour vous faire part d'une réflexion du moment. Je m'adresse en priorité aux investigateurs lancés comme moi sur les traces du Phoenix."
	},
	{ 
		site: "www.liberation-inmemoriam.fr", 
		keywords: [ "loch fyne", "fyne", "liberation", "jack lorski", "lorski", "death", "INFORMATIONS", "INFOS", "QUOTIDIEN", "POLITIQUES", "MONDE", "INTERNATIONAL", "SOCIETE", "ECONOMIE", "BOURSE", "FINANCE", "EMPLOI", "SPORT", "SPORTS", "FOOT", "SCIENCES", "MEDIAS", "CULTURE", "MUSIQUE", "CINEMA", "LIVRES", "PORTRAITS", "MULTIMEDIA", "NUMERIQUES", "FORUMS", "FORUM", "SERVICES", "LETTRES D'INFORMATIONS", "NEWSLETTERS", "DOSSIERS", "METEO", "ARCHIVES", "GUIDE TELE", "GUIDE TV" ], 
		description: "La dépouille de notre confrère Jack Lorski dont le destin a croisé depuis plusieurs années le tueur en série «le Phoenix», vient d'être retrouvée en Ecosse. Le reporter a probablement été victime de celui qu'il traquait obsessionnellement." 
	},
	{ 
		site: "www.losamigosdedante.org", 
		keywords: [ "Dante", "Carlos Echevarria Dominguez", "Antonio Maura Ribeira", "Ribeira", "Dominguez" ], 
		description: "The Dante Circle of Friends [ Carlos Echevarria Dominguez, Antonio Maura Ribeira ] is a cultural association based in Granada, Spain, that brings together all those with an interest in the Italy of yesterday and today from an historical, artistic and literary perspective." 
	},
	{ 
		site: "www.macbenach.net", 
		keywords: [ "mac benach", "macbenach", "mc benach", "mcbenach" ], 
		description: "MacBenach.net Mac Benach" 
	},
	{ 
		site: "www.maisnie-champenoise.org", 
		keywords: [ "templars", "templar", "templar alphabet", "Abraxas", "Order of the Temple", "Grandmasters Symbols", "seal", "seals", "templar writing", "templar code" ], 
		description: "Presentation of the 'La Maisnie Champenoise' company and the main orders of knighthood of the Middle Ages: Knights Templar (alphabet, Abraxas, Grand Masters, seals, and so on), Hospitallers, Teutonic Knights, etc." 
	},
	{ 
		site: "www.meroe.info", 
		keywords: [ "alphabet", "meroitic", "meroë", "meroe", "writing" ], 
		description: "The Meroitic alphabet, which consists of 23 characters, is written in two ways: hieroglyphic or cursive. The Meroitic script transcribed the language of the kingdom of Meroe until the 5th century, then disappeared completely. The Meroitic alphabet was deciphered by Francis Llewellyn Griffith in 1909, but the Meroitic language (the meaning of the resulting words) remains poorly understood."
	},
	{ 
		site: "www.naadirossem.net", 
		keywords: [ "Naadir Ossem", "naadirossem" ], 
		description: "Naadir Ossem" 
	},
	{ 
		site: "www.nag-hammadi.com", 
		keywords: [ "Naghammadi", "Nag hammadi", "Nag Hammadi Library", "gnosis", "Christian tradition", "Nag Hammadi texts", "seven principles universe", "triple veil Isis" ], 
		description: "Naghammadi. The Nag Hammadi Library. Initiation into gnosis and the Christian tradition, as enlightened by the Nag Hammadi texts" 
	},
	{ 
		site: "www.olho-de-lisboa.info", 
		keywords: [ "Joao AMERIM", "Tiago das NEVES", "amerim", "neves", "olho lisboa" ], 
		description: "Webzine sobre o Bairro Alto de Lisboa. Vida cultural, vida associativa, noticias diversas..." 
	},
	{ 
		site: "www.per-ao.com", 
		keywords: [ "setaou", "RoSetaou", "Ro-Setaou", "I am the serpent Sata whose years are infinite", "serpent Sata", "parcours", "initiation", "pyramid", "livre", "morts", "serpent", "years", "infinite", "born", "daily", "sata", "book dead", "book deads" ], 
		description: "Vie et mort de Pharaon. Livre des Morts. Ro Setaou. I am the serpent Sata whose years are infinite. I lie down dead. I am born daily." 
	},
	{ 
		site: "www.phoenix-investigators.org", 
		keywords: [ "phoenix", "lorski", "jack lorski", "icpa" ], 
		description: "The official website for the International Comittee for the Arrestation of the Phoenix (ICPA). Informations regarding the serial killer known as the Phoenix and the related investigations."
	},
	{ 
		site: "www.phoenix-killer.info", 
		keywords: [ "phoenix", "lorski", "jack lorski", "icpa" ], 
		description: "The ICPA is a private association created by friends and colleagues of journalist Jack Lorski in the wake of his murder in Scotland. The ICPA is aimed at helping international police and law departments to bring a swift end to the Phoenix's killing spree." 
	},
	{ 
		site: "www.psykokronik.net", 
		keywords: [ "psykokronik", "amelie sorel", "graphic", "graphisme", "graphiste", "illustration", "illustrateur", "création", "site web", "website", "retouche photo", "arts", "montreal", "montréal" ], 
		description: "graphisme, illustration, création site web, retouche photo par Amelie Sorel"
	},
	{ 
		site: "www.skl-network.com", 
		keywords: [ "skl network", "jack lorski" , "lorski", "ikl network", "skl"], 
		description: "IKL NETWORK - founded in 1962 by three professional journalists, Arnaud Ivan, Stéphane Karlsberg and Marie Liloux - creates ready-to-use informational content for TV (terrestrial, cable and satellite) and the Internet." 
	},
	{ 
		site: "www.smokingbug.com", 
		keywords: [ "bakedbugs", " bugsoda", "bugsoup", "bug soup", "bug soda", "baked bug" ], 
		description: "Smokingbug.com : Brad Degannes Website. Paintings and Commercials (Bakedbugs, Bugsoda, Bugsoup)" 
	},
	{ 
		site: "www.snst-center.com", 
		keywords: [ "Smith and Norris Security Training", "SNST", "smith norris", "security training" ], 
		description: "SNST : Smith and Norris Security Training, is an approved security training center. Our mission is to offer a wide variety of training services enabling our customers to improve their safety." 
	},
	{ 
		site: "www.st-dominic-f.org", 
		keywords: [ "Charles Edwin Byron" ], 
		description: "Charles Edwin Byron - Official site of the Saint Dominic Foundation: organization overview and description of its mission." 
	},
	{ 
		site: "www.theo-makarios.info", 
		keywords: [ "professeur histoire", "moyen age", "renaissance", "antiquite", "medieval", "medieviste", "epigraphiste", "theo makarios", "phoenix" ], 
		description: "L'actualité de l'Histoire vue par Théo Makarios, historien médiéviste et épigraphiste."
	},
	{ 
		site: "www.umanista.net", 
		keywords: [ "FSKIPFT", "Hell", "Dante", "Sandro Botticelli", "Alessandro di Mariano dei Filipepi", "F.S.K.I.P.F.T.", "boticelli", "inferno", "Filipepi", "paradise", "purgatory" ], 
		description: "Italian Humanists and Faithful to Love: Sandro Botticelli, Dante (Hell, FSKIPFT, …), Raphael, Pico Della Mirandola, Leonardo Da Vinci, Petrarch, Michelangelo, Ficino, Alessandro di Mariano dei Filipepi." 
	},
	{ 
		site: "www.viagensnotempo.com", 
		keywords: [ "Por Tuo Gral", "Por Tuo Graal", "castles", "templar", "templars", "castle", "Portugal", "alfonso I" ], 
		description: "Por Tuo Gral --> Travel agency specialised in historical/cultural tours in Portugal. Knights Templar: Tomar, Almourol, Ourem." 
	},
	{ 
		site: "www.xineph.com", 
		keywords: [ "xineph" ], 
		description: "Hello, little friend." 
	},
];

var overrideKeyword = "showallwebsites";

function init(){
	// Cleanup
	for (var i = 0; i < sites.length; i++) {
		let keywords = sites[i].keywords;
		for (var j = 0; j < keywords.length; j++) {
			keywords[j] = keywords[j].toLowerCase().split(" ");
		}
		sites[i].keywords = keywords;
	}
}


function updateQuery(){

	let list = document.getElementById("results");
	list.replaceChildren([]);

	let queryString = document.getElementById("query").value.toLowerCase();
	queryString = queryString.replaceAll("+", " ");
	queryString = queryString.replaceAll(",", " ");
	let queryKeywords = queryString.split(" ").filter((token) => token.length > 0);
	
	// Support cheat override.
	let override = queryString === overrideKeyword;
	let empty = true;
	for (let i = 0; i < sites.length; i++) {
		
		let siteKeywords = sites[i].keywords;
		// Dumb keyword matching.
		if(!override){
			let found = false;
			for (let j = 0; j < siteKeywords.length; j++) {
				// Does the query contains all tokens in the keyword
				let missing = false;
				for(let k = 0; k < siteKeywords[j].length; ++k)
				{
					if(queryKeywords.indexOf(siteKeywords[j][k]) < 0){
						missing = true;
						break;
					}
				}
				// All parts have been found, the query matches one of the site keywords.
				if(!missing){
					found = true;
					break;
				}
			}
			// None of the keywords matched the query tokens.
			if(!found){
				continue;
			}
		}
		empty = false;

		let listElem = document.createElement("li");
		let title = document.createElement("a");
		title.href = "http://" + sites[i].site;
		title.target = "_blank";
	 	title.innerHTML = sites[i].site;
		let desc = document.createElement("p");
	 	desc.innerHTML = sites[i].description;
	 	if(true /*override*/){
	 		let keywordsStr = siteKeywords.map((tokens) => tokens.join(" ")).join(", ");
	 		desc.innerHTML += "<small><br><br><code>" + keywordsStr + "</code></small>";
	 	}
	 	listElem.appendChild(title);
	 	listElem.appendChild(desc);

	 	list.appendChild(listElem);
	}

	// Display helpful message for conservation.
	if(empty){
		let listElem = document.createElement("li");
		let desc = document.createElement("p");
	 	desc.innerHTML = "No result found.<br><br><small>If you are completely stuck, you can use the keyword <code>" + overrideKeyword + "</code> to reveal all websites. This will dramatically impact your experience of the game.</small>";
	 	listElem.appendChild(desc);
	 	list.appendChild(listElem);
	}
}